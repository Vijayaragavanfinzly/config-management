<div class=" mt-3">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb custom-breadcrumb p-3 rounded shadow-sm">
            <li class="breadcrumb-item">
                <a [routerLink]="['/compare']" class="breadcrumb-link">
                    COMPARE
                </a>
            </li>
            <li class="breadcrumb-item active">
                <a [routerLink]="['/compare/compareByTenant']" [routerLinkActive]="['active']" class="breadcrumb-link">
                    COMPARE BY ENVIRONMENT
                </a>
            </li>
        </ol>
    </nav>
</div>
<div class="">
    <div class="compare-container">
        <div class="compare-cards">
            <div class="tenant-card">


                <!-- First Environment Select -->
                <mat-form-field appearance="outline" class="search-select">
                    <mat-label>Select Environment 1</mat-label>
                    <mat-select [(ngModel)]="selectedEnv1" panelClass="custom-select-panel" required>
                        <mat-option>
                            <ngx-mat-select-search [formControl]="searchInput" placeholderLabel="Search..."
                                noEntriesFoundLabel="No options found"></ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let option of environments" [value]="option">
                            {{ option | uppercase }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>


                <!-- Second Environment Select -->
                <mat-form-field appearance="outline" class="search-select">
                    <mat-label>Select Environment 2</mat-label>
                    <mat-select [(ngModel)]="selectedEnv2" panelClass="custom-select-panel" required>
                        <mat-option>
                            <ngx-mat-select-search [formControl]="searchInput" placeholderLabel="Search..."
                                noEntriesFoundLabel="No options found"></ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let option of environments" [value]="option">
                            {{ option | uppercase }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

            </div>
            <div class="action-buttons">
                <button class="btn-primary" id="compareButton" (click)="compareEnvironments()">
                    <i class="fas fa-bolt"></i> Compare
                </button>
                <button class="btn-secondary" id="clearButton" (click)="clearSelections()">
                    <i class="fas fa-eraser"></i> Clear
                </button>
            </div>
        </div>
        <div *ngIf="tenantsOfEnv1.length > 0 || tenantsOfEnv2.length > 0" class="available-tenants">
            <span *ngIf="tenantsOfEnv1.length > 0" class="tenants-inline">
                <strong>Tenants in {{ selectedEnv1 | uppercase }}:</strong>
                {{ tenantsOfEnv1.join(', ').toUpperCase() }}
            </span>
            <div class="divider"></div>
            <span *ngIf="tenantsOfEnv2.length > 0" class="tenants-inline">
                <strong>Tenants in {{ selectedEnv2 | uppercase }}:</strong>
                {{ tenantsOfEnv2.join(', ').toUpperCase() }}
            </span>
        </div>

    </div>
</div>
<!--  -->




<div *ngIf="loading" class="spinner-container">
    <app-spinner></app-spinner>
</div>

<div *ngIf="!loading && (CommonProperties.length > 0 || TenantBasedProperties.length > 0)" class="mt-5 search-bar">
    <div class="form-control search-input-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" class="form-control search-input" [(ngModel)]="searchQuery"
            (input)="handleSearchQueryChange()" placeholder="Search ..." />
    </div>
</div>


<div class="tab-row">
    <div class="tab-bar"
        *ngIf="filteredCommonMatchingProperties.length > 0 || filteredCommonNonMaatchingProperties.length > 0 || filteredTenantMatchingProperties.length > 0 || filteredTenantNonMatchingProperties.length > 0">

        <div class="tab" [ngClass]="{'active': activeTab === 'common'}" (click)="setActiveTab('common')">
            <i class="fas fa-info-circle info-icon"
                [matTooltip]="'Common properties are shared across all environments. Learn more in the FAQ.'"
                [routerLink]="['/faq']"></i>
            <span>Common Properties</span>
            <span class="badge">{{ nonTenantBasedSize }}</span>
        </div>


        <div class="tab active" [ngClass]="{'active': activeTab === 'tenant'}" (click)="setActiveTab('tenant')">
            <i class="fas fa-info-circle info-icon"
                [matTooltip]="'Tenant properties are specific to a tenant and their environment. Learn more in the FAQ.'"
                [routerLink]="['/faq']"></i>
            <span>Tenant Properties</span>
            <span class="badge">{{ tenantBasedSized }}</span>
        </div>



        <div class="tab" [ngClass]="{'active': activeTab === 'notInEnv1'}" (click)="setActiveTab('notInEnv1')">
            <i class="fas fa-info-circle info-icon"
                [matTooltip]="'These properties are inactive in ' + (selectedEnv1 | uppercase) + '. Learn more in the FAQ.'"
                [routerLink]="['/faq']" [queryParams]="{ faqId: 'collapseEight' }" aria-label="Information about inactive properties"></i>
            <span>Tenant Inactive {{selectedEnv1 | uppercase}}</span>
            <span class="badge">{{ propertiesNotAssociatedSize }}</span>
        </div>

        <div class="tab" [ngClass]="{'active': activeTab === 'notInEnv2'}" (click)="setActiveTab('notInEnv2')">
            <i class="fas fa-info-circle info-icon"
                [matTooltip]="'These properties are inactive in ' + (selectedEnv2 | uppercase) + '. Learn more in the FAQ.'"
                [routerLink]="['/faq']" aria-label="Information about inactive properties"></i>
            <span>Tenant Inactive {{selectedEnv2 | uppercase}}</span>
            <span class="badge">{{ propertiesNotAssociatedSize2 }}</span>
        </div>
    </div>


    <div class="dropdown-container"
        *ngIf="filteredCommonMatchingProperties.length > 0 || filteredCommonNonMaatchingProperties.length > 0 || filteredTenantMatchingProperties.length > 0 || filteredTenantNonMatchingProperties.length > 0"
        [ngClass]="{'makeNotVisibleDrapDown':(activeTab === 'notInEnv1' || activeTab === 'notInEnv2')}">
        <div class="dropdown">
            <button class="dropdown-toggle1 ps-2 d-flex justify-content-around align-items-center"
                (click)="toggleDropdown()">
                {{ selectedFilter }}
                <span class="badge3">{{ getActiveTabCount() }}</span>
                <i class="fa-solid fa-chevron-down" [ngClass]="{'rotated': showDropdown}"></i>
            </button>
            <div class="dropdown-menu" [class.show]="showDropdown">
                <ng-container *ngIf="activeTab === 'tenant'">
                    <div class="dropdown-item" (click)="selectFilter('Matching')">
                        <i class="fa-solid fa-check"></i>
                        <span>Matching</span>
                        <span class="badge2">{{ tenantPropertySameSize }}</span>
                    </div>
                    <div class="dropdown-item" (click)="selectFilter('Non-Matching')">
                        <i class="fa-solid fa-times"></i>
                        <span>Non-Matching</span>
                        <span class="badge2">{{ tenantPropertyDifferentSize }}</span>
                    </div>
                </ng-container>
                <ng-container *ngIf="activeTab === 'common'">
                    <div class="dropdown-item" (click)="selectFilter('Matching')">
                        <i class="fa-solid fa-check"></i>
                        <span>Matching</span>
                        <span class="badge2">{{ nonTenantPropertySameSize }}</span>
                    </div>
                    <div class="dropdown-item" (click)="selectFilter('Non-Matching')">
                        <i class="fa-solid fa-times"></i>
                        <span>Non-Matching</span>
                        <span class="badge2">{{ nonTenantPropertyDifferentSize }}</span>
                    </div>
                </ng-container>
            </div>
        </div>
    </div>

</div>


<div *ngIf="filteredCommonMatchingProperties.length > 0 && activeTab === 'common' && selectedFilter === 'Matching' "
    class="table-responsive">
    <div class="table-responsive table-container">


        <table class="table custom-table shadow-sm">
            <thead>
                <tr>
                    <th *ngFor="let column of commonPropertiesColumns; let i = index"
                        [ngStyle]="{'width': column.width + 'px', 'max-width': column.width + 'px'}"
                        class="text-center position-relative">
                        {{ column.name }}

                        <div class="resize-handle" (mousedown)="onMouseDown($event, i, 'common')"></div>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                <tr *ngFor="let entry of paginatedSameData">
                    <td class="" [innerHTML]="highlightText(entry.propertyKey.key || '-', searchQuery)"
                        (contextmenu)="onRightClickForCopy($event, entry, 'propertyKey')">
                    </td>
                    <td class=""
                        [innerHTML]="highlightText(entry.env1Value.value !== '' ? entry.env1Value.value : '-', searchQuery)"
                        (contextmenu)="onRightClickForCopy($event, entry, 'env1Value')"></td>
                </tr>
            </tbody>
        </table>
        <div *ngIf="showContextMenuCopy" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="copyEntryForCommon()" data-tooltip="Copy the property value">
                    <i class="fas fa-copy"></i> Copy
                </li>
            </ul>
        </div>
    </div>
    <div class="pagination-container d-flex justify-content-between align-items-center mt-3 mb-3">
        <div class="total-records">
            Total Records: <strong>{{sizeOfCommonMatching}}</strong>
        </div>

        <div class="pagination-controls d-flex align-items-center">
            <span class="pagination-nav" [class.disabled]="currentPage === 1" (click)="goToPreviousPage()">
                <i class="fas fa-angle-double-left"></i>
            </span>
            <ng-container *ngFor="let page of pages">
                <span *ngIf="page !== -1" class="pagination-page" [class.active]="page === currentPage"
                    (click)="goToPage(page)">
                    {{ page }}
                </span>
                <span *ngIf="page === -1" class="pagination-dots">...</span>
            </ng-container>
            <span class="pagination-nav" [class.disabled]="currentPage === totalPages" (click)="goToNextPage()">
                <i class="fas fa-angle-double-right"></i>
            </span>
        </div>

        <div class="items-per-page">
            <div for="pageSize" class="me-2 total-records">Items per page:</div>
            <select id="pageSize" class="form-select d-inline-block w-auto" [(ngModel)]="pageSize"
                (change)="updatePagination()">
                <option [value]="10">10</option>
                <option [value]="20">20</option>
                <option [value]="50">50</option>
                <option [value]="100">100</option>
            </select>
        </div>
    </div>
</div>
<div
    *ngIf="(CommonProperties.length > 0 || TenantBasedProperties.length > 0) && filteredCommonMatchingProperties.length === 0 && activeTab === 'common' && selectedFilter === 'Matching' && searchQuery === ''">
    <div class="no-data-container modern-ui">
        <div class="no-data-card modern-card">
            <i class="fas fa-search no-data-icon floating-icon"></i>
            <h2 class="no-data-title">Oops! No Matching Data</h2>
            <p class="no-data-message">
                We couldn’t find any properties matching your selection. Try tweaking your filters or resetting your
                search to explore more options.
            </p>
        </div>
    </div>
</div>


<div *ngIf="filteredCommonNonMaatchingProperties.length > 0 && activeTab === 'common' && selectedFilter === 'Non-Matching' "
    class="table-responsive">
    <div class="table-container table-responsive">


        <table class="table custom-table shadow-sm">
            <thead>
                <tr>
                    <th *ngFor="let column of commonPropertiesColumns_different; let i = index"
                        [ngStyle]="{'width': column.width + 'px', 'max-width': column.width + 'px'}"
                        class="text-center position-relative">
                        <span *ngIf="column.name === 'Property Value 1'">
                            {{ selectedEnv1 }}
                        </span>
                        <span *ngIf="column.name === 'Property Value 2'">
                            {{ selectedEnv2 }}
                        </span>
                        <span *ngIf="column.name !== 'Property Value 1' && column.name !== 'Property Value 2'">
                            {{ column.name }}
                        </span>

                        <div class="resize-handle" (mousedown)="onMouseDown($event, i, 'common_different')">
                        </div>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                <tr *ngFor="let entry of paginatedDifferentData">
                    <td class="" [innerHTML]="highlightText(entry.propertyKey.key || '-', searchQuery)"
                        (contextmenu)="onRightClickForCopy($event, entry, 'propertyKey')">
                    </td>
                    <td class="" [ngClass]="{'not-available':entry.env1Value.value === 'not available',
                            'devops-input': entry.env1Value.value === 'DEVOPS_INPUT',
                            'ops-input': entry.env1Value.value === 'OPS_INPUT'
                         }"
                        (contextmenu)="entry.env1Value.value === 'not available' ? onRightClickForAdd($event, entry, 'env1Value') : onRightClick($event, entry, 'env1Value')">

                        <span [ngClass]="{
                        'not-available-inside':entry.env1Value.value === 'not available',
                        'devops-input-inside': entry.env1Value.value === 'DEVOPS_INPUT',
            'ops-input-inside': entry.env1Value.value === 'OPS_INPUT'
                    }" [innerHTML]="highlightText(entry.env1Value.value === 'not available' ? 'MISSING_KEY' : entry.env1Value.value || '-', searchQuery)"></span>
                    </td>
                    <td class="text-center">
                        <i class="fas fa-arrow-circle-right action-icon me-2" title="Copy Value 1 to Tenant 2" (click)="openConfirmationDialog2(
                            entry,
                            'env1Value',
                            'env2Value'
                          )" style="color: red;"></i>

                        <i class="fas fa-arrow-circle-left action-icon me-2" title="Copy Value 2 to Tenant 1" (click)="openConfirmationDialog2(
                            entry,
                            'env2Value',
                            'env1Value'
                          )" style="color: red;"></i>
                    </td>
                    <td class="" [ngClass]="{'not-available':entry.env2Value.value === 'not available' ,
                            'devops-input': entry.env2Value.value === 'DEVOPS_INPUT',
                            'ops-input': entry.env2Value.value === 'OPS_INPUT'
                        }"
                        (contextmenu)="entry.env2Value.value === 'not available' ? onRightClickForAdd($event, entry, 'env2Value') : onRightClick($event, entry, 'env2Value')">

                        <span [ngClass]="{
                        'not-available-inside':entry.env2Value.value === 'not available',
                        'devops-input-inside': entry.env2Value.value === 'DEVOPS_INPUT',
            'ops-input-inside': entry.env2Value.value === 'OPS_INPUT'
                    }" [innerHTML]="highlightText(entry.env2Value.value === 'not available' ? 'MISSING_KEY' : entry.env2Value.value || '-', searchQuery)"></span>
                    </td>
                </tr>
            </tbody>
        </table>
        <div *ngIf="showContextMenu" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="editEntryCommon()" data-tooltip="Edit this property">
                    <i class="fas fa-edit"></i> Edit
                </li>
                <li (click)="copyEntryForCommon()" data-tooltip="Copy the property value">
                    <i class="fas fa-copy"></i> Copy
                </li>
            </ul>
        </div>
        <div *ngIf="showContextMenuCopy" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="copyEntryForCommon()" data-tooltip="Copy the property value">
                    <i class="fas fa-copy"></i> Copy
                </li>
            </ul>
        </div>
        <div *ngIf="showContextMenuAdd" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="addProperty2()" data-tooltip="Edit this property">
                    <i class="fas fa-edit"></i> Add
                </li>
            </ul>
        </div>
    </div>
    <div class="pagination-container d-flex justify-content-between align-items-center mt-3 mb-3">
        <div class="total-records">
            Total Records: <strong>{{sizeOfCommonNonMatching}}</strong>
        </div>

        <div class="pagination-controls d-flex align-items-center">
            <span class="pagination-nav" [class.disabled]="currentPage === 1" (click)="goToPreviousPage()">
                <i class="fas fa-angle-double-left"></i>
            </span>
            <ng-container *ngFor="let page of pages">
                <span *ngIf="page !== -1" class="pagination-page" [class.active]="page === currentPage"
                    (click)="goToPage(page)">
                    {{ page }}
                </span>
                <span *ngIf="page === -1" class="pagination-dots">...</span>
            </ng-container>
            <span class="pagination-nav" [class.disabled]="currentPage === totalPages" (click)="goToNextPage()">
                <i class="fas fa-angle-double-right"></i>
            </span>
        </div>

        <div class="items-per-page">
            <div for="pageSize" class="me-2 total-records">Items per page:</div>
            <select id="pageSize" class="form-select d-inline-block w-auto" [(ngModel)]="pageSize"
                (change)="updatePagination()">
                <option [value]="10">10</option>
                <option [value]="20">20</option>
                <option [value]="50">50</option>
                <option [value]="100">100</option>
            </select>
        </div>
    </div>
</div>
<div
    *ngIf="(CommonProperties.length > 0 || TenantBasedProperties.length > 0) && filteredCommonNonMaatchingProperties.length === 0 && activeTab === 'common' && selectedFilter === 'Non-Matching' && searchQuery === ''">
    <div class="no-data-container modern-ui">
        <div class="no-data-card modern-card">
            <i class="fas fa-search no-data-icon floating-icon"></i>
            <h2 class="no-data-title">Oops! No Matching Data</h2>
            <p class="no-data-message">
                We couldn’t find any properties matching your selection. Try tweaking your filters or resetting your
                search to explore more options.
            </p>
        </div>
    </div>
</div>

<div *ngIf="filteredTenantMatchingProperties.length > 0 && activeTab === 'tenant' && selectedFilter === 'Matching'"
    class="table-responsive">
    <div class="table-responsive table-container">


        <table class="table custom-table shadow-sm">
            <thead>
                <tr>
                    <th *ngFor="let column of tenantPropertiesColumn_same; let i = index"
                        [ngStyle]="{'width': column.width + 'px', 'max-width': column.width + 'px'}"
                        class="text-center position-relative">
                        <span *ngIf="column.name === 'Property Key 1'">
                            {{ selectedTenant1 + " - " + selectedEnv1 + " Key"}}
                        </span>
                        <span *ngIf="column.name === 'Property Key 2'">
                            {{ selectedTenant2 + " - " + selectedEnv2 + " Key"}}
                        </span>
                        <span *ngIf="column.name !== 'Property Key 1' && column.name !== 'Property Key 2'">
                            {{ column.name }}
                        </span>

                        <div class="resize-handle" (mousedown)="onMouseDown($event, i, 'tenant_same')"></div>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                <tr *ngFor="let entry of paginatedTenantSameProperties">
                    <td class="" (contextmenu)="onRightClickForCopy($event, entry, 'propertykey')"
                        [innerHTML]="highlightText(entry.propertykey.prop_key || '-', searchQuery)"></td>
                    <td class="" (contextmenu)="onRightClickForCopy($event, entry, 'propertykey')"
                        [innerHTML]="highlightText(getFirstTenantValue(entry) || '-', searchQuery)"></td>
                </tr>
            </tbody>
        </table>
        <div *ngIf="showContextMenuCopy" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="copyEntry2()" data-tooltip="Copy the property value">
                    <i class="fas fa-copy"></i> Copy
                </li>
            </ul>
        </div>
    </div>
    <div class="pagination-container d-flex justify-content-between align-items-center mt-3 mb-3">
        <div class="total-records">
            Total Records: <strong>{{sizeOfTenantMatching}}</strong>
        </div>

        <div class="pagination-controls d-flex align-items-center">
            <span class="pagination-nav" [class.disabled]="currentPage === 1" (click)="goToPreviousPage()">
                <i class="fas fa-angle-double-left"></i>
            </span>
            <ng-container *ngFor="let page of pages">
                <span *ngIf="page !== -1" class="pagination-page" [class.active]="page === currentPage"
                    (click)="goToPage(page)">
                    {{ page }}
                </span>
                <span *ngIf="page === -1" class="pagination-dots">...</span>
            </ng-container>
            <span class="pagination-nav" [class.disabled]="currentPage === totalPages" (click)="goToNextPage()">
                <i class="fas fa-angle-double-right"></i>
            </span>
        </div>

        <div class="items-per-page">
            <div for="pageSize" class="me-2 total-records">Items per page:</div>
            <select id="pageSize" class="form-select d-inline-block w-auto" [(ngModel)]="pageSize"
                (change)="updatePagination()">
                <option [value]="10">10</option>
                <option [value]="20">20</option>
                <option [value]="50">50</option>
                <option [value]="100">100</option>
            </select>
        </div>
    </div>
</div>

<div
    *ngIf="(CommonProperties.length > 0 || TenantBasedProperties.length > 0) && filteredTenantMatchingProperties.length === 0 && activeTab === 'tenant' && selectedFilter === 'Matching' && searchQuery === ''">
    <div class="no-data-container modern-ui">
        <div class="no-data-card modern-card">
            <i class="fas fa-search no-data-icon floating-icon"></i>
            <h2 class="no-data-title">Oops! No Matching Data</h2>
            <p class="no-data-message">
                We couldn’t find any properties matching your selection. Try tweaking your filters or resetting your
                search to explore more options.
            </p>
        </div>
    </div>
</div>

<div *ngIf="filteredTenantNonMatchingProperties.length > 0 && activeTab == 'tenant' && selectedFilter == 'Non-Matching' "
    class="table-responsive">
    <div class="table-container table-responsive">


        <table class="table custom-table shadow-sm">
            <thead>
                <tr>
                    <th *ngFor="let column of differentColumns; let i = index"
                        [ngStyle]="{'width': column.width + 'px', 'max-width': column.width + 'px'}"
                        class="text-center position-relative">
                        <span *ngIf="column.name === 'Tenant 1 Value'">
                            {{ selectedEnv1 }}
                        </span>
                        <span *ngIf="column.name === 'Tenant 2 Value'">
                            {{ selectedEnv2 }}
                        </span>
                        <span *ngIf="column.name !== 'Tenant 1 Value' && column.name !== 'Tenant 2 Value'">
                            {{ column.name }}
                        </span>

                        <div class="resize-handle" (mousedown)="onMouseDown($event, i, 'different')"></div>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                <tr *ngFor="let entry of paginatedTenantDifferentProperties">
                    <td class="" (contextmenu)="onRightClickForCopy($event, entry, 'propertykey')"
                        [innerHTML]="highlightText(entry.propertykey.prop_key || '-', searchQuery)"></td>
                    <td *ngFor="let column of differentColumns.slice(1); let i = index" [ngClass]="{
        'env1-column': column.group === 'env1',
        'env2-column': column.group === 'env2',
        'not-available': entry[column.field].value === 'not available',
        'devops-input': entry[column.field].value === 'DEVOPS_INPUT',
        'ops-input': entry[column.field].value === 'OPS_INPUT'
    }" (contextmenu)="entry[column.field].value === 'not available' ? onRightClickForAdd($event, entry, column) : onRightClick($event, entry, column)">

                        <span [ngClass]="{
            'not-available-inside': entry[column.field].value === 'not available',
            'devops-input-inside': entry[column.field].value === 'DEVOPS_INPUT',
            'ops-input-inside': entry[column.field].value === 'OPS_INPUT'
        }" [innerHTML]="highlightText(
            entry[column.field].value === 'not available' ? 'MISSING KEY' : entry[column.field].value || '-',
            searchQuery)">
                        </span>
                    </td>
                </tr>
            </tbody>
        </table>
        <div *ngIf="showContextMenu" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="editEntryTenantCompare()" data-tooltip="Edit this property">
                    <i class="fas fa-edit"></i> Edit
                </li>
                <li (click)="copyEntry()" data-tooltip="Copy the property value">
                    <i class="fas fa-copy"></i> Copy
                </li>
            </ul>
        </div>
        <div *ngIf="showContextMenuCopy" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <!-- <li (click)="editEntry()" data-tooltip="Edit this property">
                    <i class="fas fa-edit"></i> Edit
                </li> -->
                <li (click)="copyEntry2()" data-tooltip="Copy the property value">
                    <i class="fas fa-copy"></i> Copy
                </li>
            </ul>
        </div>
        <div *ngIf="showContextMenuAdd" class="context-menu" [style.left.px]="menuPosition.x"
            [style.top.px]="menuPosition.y">
            <ul>
                <li (click)="addProperty()" data-tooltip="Edit this property">
                    <i class="fas fa-edit"></i> Add
                </li>
            </ul>
        </div>
    </div>
    <div class="pagination-container d-flex justify-content-between align-items-center mt-3 mb-3">
        <div class="total-records">
            Total Records: <strong>{{sizeOfTenantNonMatching}}</strong>
        </div>

        <div class="pagination-controls d-flex align-items-center">
            <span class="pagination-nav" [class.disabled]="currentPage === 1" (click)="goToPreviousPage()">
                <i class="fas fa-angle-double-left"></i>
            </span>
            <ng-container *ngFor="let page of pages">
                <span *ngIf="page !== -1" class="pagination-page" [class.active]="page === currentPage"
                    (click)="goToPage(page)">
                    {{ page }}
                </span>
                <span *ngIf="page === -1" class="pagination-dots">...</span>
            </ng-container>
            <span class="pagination-nav" [class.disabled]="currentPage === totalPages" (click)="goToNextPage()">
                <i class="fas fa-angle-double-right"></i>
            </span>
        </div>

        <div class="items-per-page">
            <div for="pageSize" class="me-2 total-records">Items per page:</div>
            <select id="pageSize" class="form-select d-inline-block w-auto" [(ngModel)]="pageSize"
                (change)="updatePagination()">
                <option [value]="10">10</option>
                <option [value]="20">20</option>
                <option [value]="50">50</option>
                <option [value]="100">100</option>
            </select>
        </div>
    </div>
</div>
<div
    *ngIf="(CommonProperties.length > 0 || TenantBasedProperties.length > 0) && filteredTenantNonMatchingProperties.length === 0 && activeTab === 'tenant' && selectedFilter === 'Non-Matching' && searchQuery === ''">
    <div class="no-data-container modern-ui">
        <div class="no-data-card modern-card">
            <i class="fas fa-search no-data-icon floating-icon"></i>
            <h2 class="no-data-title">Oops! No Matching Data</h2>
            <p class="no-data-message">
                We couldn’t find any properties matching your selection. Try tweaking your filters or resetting your
                search to explore more options.
            </p>
        </div>
    </div>
</div>








<!--===============================DATA UNKNOWN CATEGORY TABLE STARTS HERE=============================================================-->
<div *ngIf="filteredPropertiesNotAssociated.length > 0 && activeTab === 'notInEnv1'" class="table-responsive">
    <div class="table-responsive table-container">


        <table class="table custom-table shadow-sm">
            <thead>
                <tr>
                    <th *ngFor="let column of notAssociatedColumn; let i = index"
                        [ngStyle]="{'width': column.width + 'px', 'max-width': column.width + 'px'}"
                        class="text-center position-relative">
                        <span *ngIf="column.name === 'Property Key 1'">
                            {{ selectedTenant1 + " - " + selectedEnv1 + " Key"}}
                        </span>
                        <span *ngIf="column.name === 'Property Key 2'">
                            {{ selectedTenant2 + " - " + selectedEnv2 + " Key"}}
                        </span>
                        <span *ngIf="column.name !== 'Property Key 1' && column.name !== 'Property Key 2'">
                            {{ column.name }}
                        </span>

                        <div class="resize-handle" (mousedown)="onMouseDown($event, i, 'notAssociatedColumn')"></div>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                <tr *ngFor="let entry of paginatedPropertiesNotAssociated">
                    
                        <td>
                            <span [innerHTML]="highlightText(entry.prop_key || '-', searchQuery)"></span>
                        </td>
                        <td>
                            <span [innerHTML]="highlightText(entry.value || '-', searchQuery)"></span>
                        </td>
                    
                </tr>

            </tbody>
        </table>
    </div>
    <div class="pagination-container d-flex justify-content-between align-items-center mt-3 mb-3">
        <div class="total-records">
            Total Records: <strong>{{sizeOfNotAssociated}}</strong>
        </div>

        <div class="pagination-controls d-flex align-items-center">
            <span class="pagination-nav" [class.disabled]="currentPage2 === 1" (click)="goToPreviousPage()">
                <i class="fas fa-angle-double-left"></i>
            </span>
            <ng-container *ngFor="let page of pages">
                <span *ngIf="page !== -1" class="pagination-page" [class.active]="page === currentPage"
                    (click)="goToPage(page)">
                    {{ page }}
                </span>
                <span *ngIf="page === -1" class="pagination-dots">...</span>
            </ng-container>
            <span class="pagination-nav" [class.disabled]="currentPage2 === totalPages2" (click)="goToNextPage()">
                <i class="fas fa-angle-double-right"></i>
            </span>
        </div>

        <div class="items-per-page">
            <div for="pageSize" class="me-2 total-records">Items per page:</div>
            <select id="pageSize" class="form-select d-inline-block w-auto" [(ngModel)]="pageSize"
                (change)="updatePagination()">
                <option [value]="10">10</option>
                <option [value]="20">20</option>
                <option [value]="50">50</option>
                <option [value]="100">100</option>
            </select>
        </div>
    </div>
</div>
<div
    *ngIf="(CommonProperties.length > 0 || TenantBasedProperties.length > 0) && propertiesNotAssociated.length === 0 && activeTab === 'notInEnv1'">
    <div class="no-properties2-container">
        <i class="fas fa-search no-data-icon floating"></i>
        <h4>We couldn't find any matching results!</h4>
        <p class="no-data-text">
            Try refining your search or explore other options to see more data.
        </p>
    </div>
</div>

<!-- ================================================DATA UNKNOWN CATEGORY TABLE ENDS HERE======================================================== -->

<div *ngIf="filteredPropertiesNotAssociated2.length > 0 && activeTab === 'notInEnv2'" class="table-responsive">
    <div class="table-responsive table-container">


        <table class="table custom-table shadow-sm">
            <thead>
                <tr>
                    <th *ngFor="let column of notAssociatedColumn; let i = index"
                        [ngStyle]="{'width': column.width + 'px', 'max-width': column.width + 'px'}"
                        class="text-center position-relative">
                        <span *ngIf="column.name === 'Property Key 1'">
                            {{ selectedTenant1 + " - " + selectedEnv1 + " Key"}}
                        </span>
                        <span *ngIf="column.name === 'Property Key 2'">
                            {{ selectedTenant2 + " - " + selectedEnv2 + " Key"}}
                        </span>
                        <span *ngIf="column.name !== 'Property Key 1' && column.name !== 'Property Key 2'">
                            {{ column.name }}
                        </span>

                        <div class="resize-handle" (mousedown)="onMouseDown($event, i, 'notAssociatedColumn')"></div>
                    </th>
                </tr>
            </thead>
            <tbody class="table-body">
                <!-- <tr *ngFor="let entry of paginatedPropertiesNotAssociated">
                    <td class="" [innerHTML]="highlightText(entry.propertykey || '-', searchQuery)"></td>
                    <td class="" [innerHTML]="highlightText(getFirstTenantValue(entry) || '-', searchQuery)"></td>
                </tr> -->
                <tr *ngFor="let entry of paginatedPropertiesNotAssociated2">
                        <td>
                            <span [innerHTML]="highlightText(entry.prop_key || '-', searchQuery)"></span>
                        </td>
                        <td>
                            <span [innerHTML]="highlightText(entry.value || '-', searchQuery)"></span>
                        </td>
                </tr>

            </tbody>
        </table>
    </div>
    <div class="pagination-container d-flex justify-content-between align-items-center mt-3 mb-3">
        <div class="total-records">
            Total Records: <strong>{{sizeOfNotAssociated2}}</strong>
        </div>

        <div class="pagination-controls d-flex align-items-center">
            <span class="pagination-nav" [class.disabled]="currentPage2 === 1" (click)="goToPreviousPage()">
                <i class="fas fa-angle-double-left"></i>
            </span>
            <ng-container *ngFor="let page of pages">
                <span *ngIf="page !== -1" class="pagination-page" [class.active]="page === currentPage"
                    (click)="goToPage(page)">
                    {{ page }}
                </span>
                <span *ngIf="page === -1" class="pagination-dots">...</span>
            </ng-container>
            <span class="pagination-nav" [class.disabled]="currentPage2 === totalPages2" (click)="goToNextPage()">
                <i class="fas fa-angle-double-right"></i>
            </span>
        </div>

        <div class="items-per-page">
            <div for="pageSize" class="me-2 total-records">Items per page:</div>
            <select id="pageSize" class="form-select d-inline-block w-auto" [(ngModel)]="pageSize"
                (change)="updatePagination()">
                <option [value]="10">10</option>
                <option [value]="20">20</option>
                <option [value]="50">50</option>
                <option [value]="100">100</option>
            </select>
        </div>
    </div>
</div>
<div
    *ngIf="(CommonProperties.length > 0 || TenantBasedProperties.length > 0) && filteredPropertiesNotAssociated2.length == 0 && activeTab === 'notInEnv2'">
    <div class="no-properties2-container">
        <i class="fas fa-search no-data-icon floating"></i>
        <h4>We couldn't find any matching results!</h4>
        <p class="no-data-text">
            Try refining your search or explore other options to see more data.
        </p>
    </div>
</div>

<!-- ===================================================================================================================================== -->


<div class="hint-overlay" *ngIf="showOverlayHint">
    <div class="hint-container">
        <div class="hint-content">
            <div class="hint-icon">💡</div>
            <div class="hint-text">
                <strong>Tip:</strong> Right-click on table data to Edit or Copy!
            </div>
        </div>
        <button class="hint-button" (click)="hideOverlay()">Got It</button>
    </div>
</div>

<div *ngIf="!loading && searchQuery && filteredCommonMatchingProperties.length == 0  && filteredCommonNonMaatchingProperties.length === 0 && filteredTenantMatchingProperties.length === 0 && filteredTenantNonMatchingProperties.length === 0"
    class="no-results">
    <div class="no-results-content text-center">
        <i class="fas fa-search fa-3x"></i>
        <h4 class="mt-3">No Results Found</h4>
        <p class="text-muted">
            We couldn’t find anything matching "<span class="highlight">{{ searchQuery }}</span>".
        </p>
        <button class="btn btn-primary btn-try-again" (click)="clearSearch()">Try Again</button>
    </div>
</div>
<div class="hint-overlay" *ngIf="showOverlayHint1">
    <div class="hint-container">
        <div class="hint-content">
            <div class="hint-icon">🔄</div>
            <div class="hint-text">
                <strong>Sync Tip:</strong> Sync before comparing to get accurate and up-to-date results!
            </div>
        </div>
        <button class="hint-button" (click)="hideOverlay1()">Got It</button>
    </div>
</div>